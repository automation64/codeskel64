- hosts: localhost
  gather_facts: false
  vars:
    test_list:
      - "item1"
    test_dict:
      entry1: "value1"
  tasks:
    - name: "1: Set default to none"
      set_fact:
        var_default_none: "{{ non_existing_var | default( none ) }}"

    - name: "1: Show var_default_none"
      debug:
        var: var_default_none

    - name: "2: Set default to ''"
      set_fact:
        var_default_none: "{{ non_existing_var | default( '' ) }}"

    - name: "2: Show var_default_none"
      debug:
        var: var_default_none

    - name: "3: Set default to []"
      set_fact:
        var_default_none: "{{ non_existing_var | default( [] ) }}"

    - name: "3: Show var_default_none"
      debug:
        var: var_default_none

    - name: "4: Set default to {}"
      set_fact:
        var_default_none: "{{ non_existing_var | default( {} ) }}"

    - name: "4: Show var_default_none"
      debug:
        var: var_default_none

    - name: "5: Set default in missing dictionary entry"
      set_fact:
        var_default: "{{ test_dict['missing'] | default( 'missing dict entry' ) }}"

    - name: "5: Show var_default"
      debug:
        var: var_default

    - name: "6: Set default in missing list entry"
      set_fact:
        var_default: "{{ test_list[10] | default( 'missing list entry' ) }}"

    - name: "6: Show var_default"
      debug:
        var: var_default

